class Wall{init(){this.events()}events(){this.onSubmitForm()}onSubmitForm(){document.querySelector("form").addEventListener("submit",e=>{e.preventDefault(),this.ajax(e.target.username.value,e.target.password.value)})}ajax(e,t){let r={},s=root_url+"?login";r.username=e,r.password=t,fetch(s,{method:"post",body:JSON.stringify(r)}).then(e=>e.text()).then(e=>{if(document.querySelector(".message.error").classList.remove("show"),document.querySelector(".message.loggedin").classList.remove("show"),this.isJson(e)){JSON.parse(e).success?window.location.replace(redirect_url):(document.querySelector(".message.error").classList.add("show"),document.querySelector(".message.error span").innerHTML=texts["login.unauthorized"])}else document.querySelector(".message.error").classList.add("show"),document.querySelector(".message.error span").innerHTML=texts["login.error"]})}isJson(e){try{JSON.parse(e)}catch(e){return!1}return!0}}document.addEventListener("DOMContentLoaded",function(){(new Wall).init()});